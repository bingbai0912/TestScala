Avro-Json
{"type":"record","name":"Event","namespace":"org.apache.hadoop.mapreduce.jobhistory","fields":[{"name":"type","type":{"type":"enum","name":"EventType","symbols":["JOB_SUBMITTED","JOB_INITED","JOB_FINISHED","JOB_PRIORITY_CHANGED","JOB_STATUS_CHANGED","JOB_QUEUE_CHANGED","JOB_FAILED","JOB_KILLED","JOB_ERROR","JOB_INFO_CHANGED","TASK_STARTED","TASK_FINISHED","TASK_FAILED","TASK_UPDATED","NORMALIZED_RESOURCE","MAP_ATTEMPT_STARTED","MAP_ATTEMPT_FINISHED","MAP_ATTEMPT_FAILED","MAP_ATTEMPT_KILLED","REDUCE_ATTEMPT_STARTED","REDUCE_ATTEMPT_FINISHED","REDUCE_ATTEMPT_FAILED","REDUCE_ATTEMPT_KILLED","SETUP_ATTEMPT_STARTED","SETUP_ATTEMPT_FINISHED","SETUP_ATTEMPT_FAILED","SETUP_ATTEMPT_KILLED","CLEANUP_ATTEMPT_STARTED","CLEANUP_ATTEMPT_FINISHED","CLEANUP_ATTEMPT_FAILED","CLEANUP_ATTEMPT_KILLED","AM_STARTED"]}},{"name":"event","type":[{"type":"record","name":"JobFinished","fields":[{"name":"jobid","type":"string"},{"name":"finishTime","type":"long"},{"name":"finishedMaps","type":"int"},{"name":"finishedReduces","type":"int"},{"name":"failedMaps","type":"int"},{"name":"failedReduces","type":"int"},{"name":"totalCounters","type":{"type":"record","name":"JhCounters","fields":[{"name":"name","type":"string"},{"name":"groups","type":{"type":"array","items":{"type":"record","name":"JhCounterGroup","fields":[{"name":"name","type":"string"},{"name":"displayName","type":"string"},{"name":"counts","type":{"type":"array","items":{"type":"record","name":"JhCounter","fields":[{"name":"name","type":"string"},{"name":"displayName","type":"string"},{"name":"value","type":"long"}]}}}]}}}]}},{"name":"mapCounters","type":"JhCounters"},{"name":"reduceCounters","type":"JhCounters"}]},{"type":"record","name":"JobInfoChange","fields":[{"name":"jobid","type":"string"},{"name":"submitTime","type":"long"},{"name":"launchTime","type":"long"}]},{"type":"record","name":"JobInited","fields":[{"name":"jobid","type":"string"},{"name":"launchTime","type":"long"},{"name":"totalMaps","type":"int"},{"name":"totalReduces","type":"int"},{"name":"jobStatus","type":"string"},{"name":"uberized","type":"boolean"}]},{"type":"record","name":"AMStarted","fields":[{"name":"applicationAttemptId","type":"string"},{"name":"startTime","type":"long"},{"name":"containerId","type":"string"},{"name":"nodeManagerHost","type":"string"},{"name":"nodeManagerPort","type":"int"},{"name":"nodeManagerHttpPort","type":"int"}]},{"type":"record","name":"JobPriorityChange","fields":[{"name":"jobid","type":"string"},{"name":"priority","type":"string"}]},{"type":"record","name":"JobQueueChange","fields":[{"name":"jobid","type":"string"},{"name":"jobQueueName","type":"string"}]},{"type":"record","name":"JobStatusChanged","fields":[{"name":"jobid","type":"string"},{"name":"jobStatus","type":"string"}]},{"type":"record","name":"JobSubmitted","fields":[{"name":"jobid","type":"string"},{"name":"jobName","type":"string"},{"name":"userName","type":"string"},{"name":"submitTime","type":"long"},{"name":"jobConfPath","type":"string"},{"name":"acls","type":{"type":"map","values":"string"}},{"name":"jobQueueName","type":"string"},{"name":"workflowId","type":["null","string"],"default":null},{"name":"workflowName","type":["null","string"],"default":null},{"name":"workflowNodeName","type":["null","string"],"default":null},{"name":"workflowAdjacencies","type":["null","string"],"default":null},{"name":"workflowTags","type":["null","string"],"default":null}]},{"type":"record","name":"JobUnsuccessfulCompletion","fields":[{"name":"jobid","type":"string"},{"name":"finishTime","type":"long"},{"name":"finishedMaps","type":"int"},{"name":"finishedReduces","type":"int"},{"name":"jobStatus","type":"string"},{"name":"diagnostics","type":["null","string"],"default":null}]},{"type":"record","name":"MapAttemptFinished","fields":[{"name":"taskid","type":"string"},{"name":"attemptId","type":"string"},{"name":"taskType","type":"string"},{"name":"taskStatus","type":"string"},{"name":"mapFinishTime","type":"long"},{"name":"finishTime","type":"long"},{"name":"hostname","type":"string"},{"name":"port","type":"int"},{"name":"rackname","type":"string"},{"name":"state","type":"string"},{"name":"counters","type":"JhCounters"},{"name":"clockSplits","type":{"type":"array","items":"int"}},{"name":"cpuUsages","type":{"type":"array","items":"int"}},{"name":"gpuUsages","type":{"type":"array","items":"int"}},{"name":"vMemKbytes","type":{"type":"array","items":"int"}},{"name":"physMemKbytes","type":{"type":"array","items":"int"}}]},{"type":"record","name":"ReduceAttemptFinished","fields":[{"name":"taskid","type":"string"},{"name":"attemptId","type":"string"},{"name":"taskType","type":"string"},{"name":"taskStatus","type":"string"},{"name":"shuffleFinishTime","type":"long"},{"name":"sortFinishTime","type":"long"},{"name":"finishTime","type":"long"},{"name":"hostname","type":"string"},{"name":"port","type":"int"},{"name":"rackname","type":"string"},{"name":"state","type":"string"},{"name":"counters","type":"JhCounters"},{"name":"clockSplits","type":{"type":"array","items":"int"}},{"name":"cpuUsages","type":{"type":"array","items":"int"}},{"name":"gpuUsages","type":{"type":"array","items":"int"}},{"name":"vMemKbytes","type":{"type":"array","items":"int"}},{"name":"physMemKbytes","type":{"type":"array","items":"int"}}]},{"type":"record","name":"TaskAttemptFinished","fields":[{"name":"taskid","type":"string"},{"name":"attemptId","type":"string"},{"name":"taskType","type":"string"},{"name":"taskStatus","type":"string"},{"name":"finishTime","type":"long"},{"name":"rackname","type":"string"},{"name":"hostname","type":"string"},{"name":"state","type":"string"},{"name":"counters","type":"JhCounters"}]},{"type":"record","name":"TaskAttemptStarted","fields":[{"name":"taskid","type":"string"},{"name":"taskType","type":"string"},{"name":"attemptId","type":"string"},{"name":"startTime","type":"long"},{"name":"trackerName","type":"string"},{"name":"httpPort","type":"int"},{"name":"shufflePort","type":"int"},{"name":"containerId","type":"string"},{"name":"locality","type":["null","string"],"default":null},{"name":"avataar","type":["null","string"],"default":null}]},{"type":"record","name":"TaskAttemptUnsuccessfulCompletion","fields":[{"name":"taskid","type":"string"},{"name":"taskType","type":"string"},{"name":"attemptId","type":"string"},{"name":"finishTime","type":"long"},{"name":"hostname","type":"string"},{"name":"port","type":"int"},{"name":"rackname","type":"string"},{"name":"status","type":"string"},{"name":"error","type":"string"},{"name":"counters","type":["null","JhCounters"],"default":null},{"name":"clockSplits","type":{"type":"array","items":"int"}},{"name":"cpuUsages","type":{"type":"array","items":"int"}},{"name":"gpuUsages","type":{"type":"array","items":"int"}},{"name":"vMemKbytes","type":{"type":"array","items":"int"}},{"name":"physMemKbytes","type":{"type":"array","items":"int"}}]},{"type":"record","name":"TaskFailed","fields":[{"name":"taskid","type":"string"},{"name":"taskType","type":"string"},{"name":"finishTime","type":"long"},{"name":"error","type":"string"},{"name":"failedDueToAttempt","type":["null","string"]},{"name":"status","type":"string"},{"name":"counters","type":["null","JhCounters"],"default":null}]},{"type":"record","name":"TaskFinished","fields":[{"name":"taskid","type":"string"},{"name":"taskType","type":"string"},{"name":"finishTime","type":"long"},{"name":"status","type":"string"},{"name":"counters","type":"JhCounters"},{"name":"successfulAttemptId","type":["null","string"],"default":null}]},{"type":"record","name":"TaskStarted","fields":[{"name":"taskid","type":"string"},{"name":"taskType","type":"string"},{"name":"startTime","type":"long"},{"name":"splitLocations","type":"string"}]},{"type":"record","name":"TaskUpdated","fields":[{"name":"taskid","type":"string"},{"name":"finishTime","type":"long"}]}]}]}
{"type":"AM_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.AMStarted":{"applicationAttemptId":"appattempt_1540267209011_318173_000001","startTime":1540377957243,"containerId":"container_e06_1540267209011_318173_01_000001","nodeManagerHost":"BJLFRZ-10k-47-167.hadoop.jd.local","nodeManagerPort":50086,"nodeManagerHttpPort":8042}}}

{"type":"JOB_SUBMITTED","event":{"org.apache.hadoop.mapreduce.jobhistory.JobSubmitted":{"jobid":"job_1540267209011_318173","jobName":"[gaoxiangbin,172.22.185.27,BUFFALO,473568,420600667,b8306643-d5cf-48ca-822a-8b7673117c38]","userName":"dd_edw_test","submitTime":1540377954416,"jobConfPath":"hdfs://ns6/userlogs/dd_edw_test/.staging/job_1540267209011_318173/job.xml","acls":{},"jobQueueName":"bdp_jdw_dd_edw_test","workflowId":{"string":"hive_dd_edw_test_20181024180027_b18da116-a8d1-44f4-ba7c-23653ca373f5"},"workflowName":{"string":"insert overwrite table tmp_test.tmp_m07_total_promotion_self_1_test partition (dt)  --加工方式记得改\nselect\n        unit.id                                           as promt_id                   --促销编号\n        ,unit.type                                        as promt_type_cd              --促销类型\n        ,case when fullrefundtype in (0,5,21,22)      then '满赠'\n              when fullrefundtype in (1,2,3,4)        then  '满减'\n              when fullrefundtype in (6,13,14,15,24 ) then  '满件'\n              when fullrefundtype in (16,17,20,23 )   then  '商品池促销'\n        else '未知' end                                   as promt_ext_first_type_desc  --促销一级扩展类型\n        ,unit.fullrefundtype                              as promt_ext_second_type_cd   --促销二级扩展类型\n        ,case when fullrefundtype=0  then '满赠'\n              when fullrefundtype=1  then '满减'\n              when fullrefundtype=2  then '每满减'\n              when fullrefundtype=3  then '百分比满减'\n              when fullrefundtype=4  then '阶梯满减'\n              when fullrefundtype=5  then '加价购'\n              when fullrefundtype=6  then '买M件减N件'\n              when fullrefundtype=20 then '商品池满减'\n              when fullrefundtype=23 then '商品池满件'\n              when fullrefundtype=13 then 'M元买N件'\n              when fullrefundtype=14 then '满M件赠N件'\n              when fullrefundtype=15 then '满M件N折'\n              when fullrefundtype=16 then '满元'\n              when fullrefundtype=17 then '满件'\n              when fullrefundtype=21 then '阶梯满赠'\n              when fullrefundtype=22 then '阶梯加价购'\n              when fullrefundtype=24 then '满件加价购'\n        ELSE '未知' end                                   as promt_ext_second_type_desc\n        ,CASE\n                 WHEN (fullrefundtype = 0 or fullrefundtype=21) THEN\n                  concat('满', nvl(totalpromorule.needMoney, 'non'), '元赠')\n                 WHEN (fullrefundtype = 5 or fullrefundtype = 22) THEN\n                  concat('满',\n                         nvl(totalpromorule.needMoney, 'non'),\n                         '元另加',\n                         nvl(totalpromorule.addMoney, 'non'),\n                         '元购')\n                 WHEN (fullrefundtype = 1 or fullrefundtype = 4) THEN  --\n                  concat('满',\n                         nvl(jieti.needMoney, 'non'),\n                         '元减',\n                         nvl(nvl(jieti.num, promotiontoken.num),'non'),\n                         '元')\n                 WHEN fullrefundtype = 2 THEN  ---\n                  concat('每满',\n                         nvl(jieti.needMoney, 'non'),\n                         '元减',\n                         nvl(jieti.num, 'non'),\n                         '元',\n                         nvl(unit.topdiscount, 'non'),\n                         '封顶')\n                 WHEN fullrefundtype = 3 THEN\n                  concat('满',\n                         nvl(totalpromorule.needMoney, 'non'),\n                         '元直减',\n                         nvl(totalpromorule.rate * 100, 'non'),\n                         '%')\n                 WHEN fullrefundtype = 6 THEN\n                  concat('满',\n                         nvl(totalpromorule.needNum, 'non'),\n                         '件免',\n                         nvl(totalpromorule.num, 'non'),\n                         '件')\n                 WHEN fullrefundtype = 13 THEN\n                  concat(nvl(totalpromorule.needMoney, 'non'), '元', nvl(totalpromorule.num, 'non'), '件')\n                 WHEN fullrefundtype = 14 THEN\n                  concat('满', nvl(totalpromorule.needNum, 'non'), '件赠', nvl(totalpromorule.num, 'non')) ---满M件赠N件\n                 WHEN fullrefundtype = 15 THEN\n                  concat('满',\n                         nvl(totalpromorule.needNum, 'non'),\n                         '件',\n                         nvl(totalpromorule.rate * 10, 'non'),\n                         '折')\n                 WHEN fullrefundtype = 20 THEN   ---\n                  concat('满最少',\n                         nvl(jieti.minpoolnum, 'non'),\n                         '池,每个池最少购买',\n                         nvl(jieti.minskunum, 'non'),\n                         '最多购买',\n                         nvl(jieti.maxskunum, 'non'),\n                         '件商品，且满',\n                         nvl(jieti.needMoney, 'non'),\n                         '元',\n                         (case\n                           when jieti.num > 0 then\n                            concat('减', nvl(jieti.num, 'non'), '元')\n                           else\n                            concat('打', nvl(jieti.rate * 10, 'non'), '折')\n                         end))\n                 WHEN fullrefundtype = 23 THEN  ----\n                  concat('满最少',\n                         nvl(jieti.minpoolnum, 'non'),\n                         '池,每个池最少购买' + nvl(totalpromorule.minskunum, 'non'),\n                         '最多购买',\n                         nvl(jieti.maxskunum, 'non'),\n                         '件商品，且满',\n                         nvl(jieti.needNum, 'non'),\n                         '件',\n                         (case\n                           when jieti.num > 0 then\n                            concat('减', nvl(jieti.num, 'non'), '元')\n                           else\n                            concat('打', nvl(jieti.rate * 10, 'non'), '折')\n                         end))\n                 WHEN fullrefundtype = 24 THEN\n                  concat('满',\n                         nvl(totalpromorule.needNum, 'non'),\n                         '件另加',\n                         nvl(promotionlargess.buyprice,totalpromorule.buyprice),\n                         '元购')\n        end                                                                   as promt_rule_desc            --规则说明\n        ,unit.name                                                            as promt_name                 --促销名称\n        ,promotionmainproduct.idmainproduct                                   as main_sku_id                --主商品编号\n        ,promotionmainproduct.num                                             as main_sku_num               --主品数量\n        ,unit.minnum                                                          as min_num                    --单次购买最小数量\n        ,promotionmainproduct.buytype                                         as main_sku_buytype_cd        --主品购买类型\n        ,promotionmainproduct.price                                           as main_sku_price             --主品会员价\n        ,promotionmainproduct.inprice                                         as main_sku_inprice           --主品进货价\n        ,promotionmainproduct.cbj                                             as main_sku_cbj               --主品仓报价\n        ,promotionmainproduct.yn                                              as main_sku_valid_flag        --主品是否有效\n        ,nvl(promotionlargess.idproduct,totalpromorule.idproduct)             as largess_sku_id             --赠送商品编号\n        ,nvl(promotionlargess.num,totalpromorule.num1)                        as largess_sku_num            --赠品数量\n        ,nvl(promotionlargess.awardtype,totalpromorule.awardtype)             as largess_type_cd            --赠送类型\n        ,nvl(promotionlargess.price,totalpromorule.price)                     as largess_sku_price          --赠品会员价\n        ,nvl(promotionlargess.inprice,totalpromorule.inprice)                 as largess_sku_inprice        --赠品进货价\n        ,nvl(promotionlargess.cbj,totalpromorule.cbj)                         as largess_sku_cbj            --赠品仓报价\n        ,nvl(promotionlargess.yn ,totalpromorule.yn)                          as largess_sku_valid_flag     --赠品有效标识\n        ,nvl(promotionlargess.skutype,totalpromorule.skutype)                 as largess_sku_type_cd        --赠品商品类型\n        ,nvl(promotionlargess.poolno,totalpromorule.poolno)                   as pool_num                   --赠品池编号\n        ,nvl(if((fullrefundtype = 1 or fullrefundtype = 4) or fullrefundtype = 2  or  fullrefundtype = 20 or  fullrefundtype = 23,jieti.rid,totalpromorule.rid),0 )                                       as every_rule_num\n        ,totalpromorule.needmoney                                             as need_amount                --每满返购满金额\n        ,totalpromorule.addmoney                                              as add_amount                 --每满返附加金额\n        ,nvl(jieti.num,promotiontoken.num)                                    as return_amount              --每满返返还金额\n        ,totalpromorule.yn                                                    as every_return_valid_flag    --每满返是否有效\n        ,nvl(promotionlargess.buyprice,totalpromorule.buyprice)               as exchange_price             --满件换购价\n        ,totalpromorule.neednum                                               as need_num                   --每满返购满数量\n        ,totalpromorule.num                                                   as give_num                   --每满返赠送数量\n        ,totalpromorule.minpoolnum                                            as min_pool_num               --每满返最小购买池数\n        ,totalpromorule.minskunum                                             as every_pool_min_sku_num     --每满返每个池最小购买商品数\n        ,totalpromorule.rate                                                  as every_return_rate          --每满返比率\n        ,case when fullrefundtype in (1,2,4,20,23,13,16,17) then '减钱'\n              when fullrefundtype in (0,14,21,6)            then '送赠品'\n              when fullrefundtype in (5,22,24 )             then '加价购'\n              when fullrefundtype in (3,15 )                then '打折'\n        else '未知' end                                                       as return_exttype_desc\n        ,sku_cate_flag\n        ,promotionsuppliers.suppliertype                                      as supplier_type              --供应商类型\n        ,promotionsuppliers.suppliercode                                      as supplier_code              --供应商简码(商家编号)\n        ,promotionsuppliers.suppliername                                      as supplier_name              --供应商名称(商家名称)\n        ,otc_tm                                                                                             --上柜时间\n        ,utc_tm                                                                                             --下柜时间\n        ,unit.timebegin                                                       as begin_time                 --预期开始时间\n        ,unit.effect_tm                                                       as effect_time                --促销生效时间\n        ,unit.timeend                                                         as end_time                   --预期结束时间\n        ,unit.ischecked                                                       as check_flag                 --审核标志\n        ,unit.createpin                                                       as create_pin                 --创建人\n        ,unit.createdate                                                      as create_time                --创建时间\n        ,unit.checkeddate                                                     as check_time                 --审核时间\n        ,unit.isdelete                                                        as delete_flag                --删除标志\n        ,if(unit.isdelete =1,unit.delete_tm,null)                             as delete_time                --删除时间\n        ,unit.promostate                                                      as promt_state                --促销状态\n        ,nvl(jieti.type,promotiontoken.type)                                  as token_type                 --促销道具类型\n        ,promotiontoken.tokenType                                             as token_id                   --令牌id\n        ,nvl(jieti.io,promotiontoken.io)                                      as promt_condition            --促销条件、奖励\n        ,nvl(jieti.num,promotiontoken.num)                                    as promt_condition_num        --条件、奖励数量\n        ,promoarea.type                                                       as promoarea_limit_type_cd    --促销区域限制类型\n        ,promoarea.area                                                       as province_id                --促销省份编号\n        ,unit.sites                                                           as promt_sites_cd             --促销渠道\n        ,unit.source                                                          as source                     --促销来源\n        ,unit.notes                                                           as promt_notes                --促销说明\n        ,unit.levelmember                                                     as member_level               --会员等级\n        ,unit.vender_id                                                       as vender_id                  --商家编号\n        ,unit.adword                                                          as adword                     --促销广告词\n        ,urlstr\n        ,0                                                                    as platform_promt_type_cd     --平台级促销类型\n        ,case when timeend_dt>'2018-10-23'  then '4712-12-31'\n              else timeend_dt                                                                               --存储方式记得改\n        end                                                                   as dt\nfrom\n(\n    select\n            id\n            ,type\n            ,fullrefundtype\n            ,name\n            ,levelmember\n            ,timebegin\n            ,timeend\n            ,ischecked\n            ,createpin\n            ,createdate\n            ,checkeddate\n            ,needmoney\n            ,addmoney\n            ,sites\n            ,source\n            ,notes\n            ,isdelete\n            ,vender_id\n            ,promostate\n            ,adword\n            ,minnum\n            ,topdiscount\n            ,sku_cate_flag\n            ,if(effect_tm>timebegin,effect_tm,timebegin)  as effect_tm\n            ,timeend_dt\n            ,delete_tm\n            ,urlstr\n    from\n    (\n        select\n                id\n                ,type\n                ,fullrefundtype\n                ,name\n                ,levelmember\n                ,timebegin\n                ,timeend\n                ,ischecked\n                ,COALESCE(operateinfo.operator,x.createpin) as createpin\n                ,createdate\n                ,checkeddate\n                ,needmoney\n                ,addmoney\n                ,sites\n                ,source\n                ,notes\n                ,isdelete\n                ,vender_id\n                ,promostate\n                ,adword\n                ,minnum\n                ,topdiscount\n                ,delete_tm\n                ,effect_tm\n                ,sku_cate_flag\n                ,urlstr\n                ,substr(COALESCE(if(isdelete=1 and operateinfo.delete_tm<=x.timeend,operateinfo.delete_tm,x.timeend),x.timeend),1,10)      as  timeend_dt\n        from\n        (\n            select\n                    id\n                    ,type\n                    ,fullrefundtype\n                    ,name\n                    ,levelmember\n                    ,timebegin\n                    ,timeend\n                    ,ischecked\n                    ,createpin\n                    ,createdate\n                    ,checkeddate\n                    ,needmoney\n                    ,addmoney\n                    ,sites\n                    ,source\n                    ,notes\n                    ,isdelete\n                    ,vender_id\n                    ,promostate\n                    ,adword\n                    ,minnum\n                    ,topdiscount\n                    ,urlstr\n                    ,if( z.promoid is null,1,2) as sku_cate_flag  --1 按sku创建  2 按品类创建\n            from\n            (\n                select\n                        id\n                        ,type\n                        ,fullrefundtype\n                        ,name\n                        ,levelmember\n                        ,timebegin\n                        ,timeend\n                        ,ischecked\n                        ,createpin\n                        ,createdate\n                        ,checkeddate\n                        ,needmoney\n                        ,addmoney\n                        ,sites\n                        ,source\n                        ,notes\n                        ,isdelete\n                        ,vender_id\n                        ,promostate\n                        ,adword\n                        ,minnum\n                        ,topdiscount\n                        ,urlstr\n                from fdm.fdm_pricemanage_promotionunit_chain\n                where dp in( 'ACTIVE','HISTORY')\n                and type=10\n                and name not like '%测试%' and name not like '%test%'\n                group by\n                          id\n                          ,type\n                          ,fullrefundtype\n                          ,name\n                          ,levelmember\n                          ,timebegin\n                          ,timeend\n                          ,ischecked\n                          ,createpin\n                          ,createdate\n                          ,checkeddate\n                          ,needmoney\n                          ,addmoney\n                          ,sites\n                          ,source\n                          ,notes\n                          ,isdelete\n                          ,vender_id\n                          ,promostate\n                          ,adword\n                          ,minnum\n                          ,topdiscount\n                          ,urlstr\n            )xx\n            left outer join\n            (\n                select\n                        promoid\n                from fdm.fdm_pricemanage_promotioncataloglist_chain\n                where dp in( 'ACTIVE','HISTORY')\n                and promotype=10\n                and  (catalog1  not in  ('9259','10825')  or catalog1 is null)\n                group by promoid\n            )z on  xx.id=z.promoid\n\n        )x\n        left outer join\n        (\n            select\n                    promoid\n                    ,max(delete_tm) as delete_tm\n                    ,max(effect_tm) as effect_tm\n                        ,max(operator) as operator\n            from\n            (\n                select\n                        promoid\n                        --,if(operatetype in (6,7),operatetime,null) as delete_tm\n                        ,case when operatetype=6 then operatetime\n                              when operatetype=7 and opinion like '%删除%' then operatetime\n                        else null\n                        end as delete_tm\n                        ,if(operatetype in  (1,2,3,4,5,10,32),operatetime,null) as effect_tm\n                        ,if(operatetype=1,operator,null) as operator\n                from fdm.fdm_pricemanage_promotionoperateinfo_chain\n                where dp in( 'ACTIVE','HISTORY') and promotype=10\n                and operatetype in  (1,2,3,4,5,6,7,10,32)\n                --1:创建 2:经理审核 3: 总监审核 4: 副总裁审核\n                --5:质控审核 6:删除 7:system 8:追加令牌\n                --9:删除令牌 10:启动促销 11：暂停促销\n                --12：修改促销  总价促销提交促销使用\n                --13:增加 41:追加 42 删除 43追加删除 14:删除促销商品\n                --15:删除赠品 16：赠品地区退出促销\n                --32:促销计划创建\n            )s\n            group by\n            promoid\n        )operateinfo\n        on x.id=operateinfo.promoid\n    )y\n    where timeend_dt>='2018-10-23'    ---初始化改这里就行了\n    --where timeend_dt>='2017-08-20'\n)unit\nleft outer join\n(\n    select\n            idcampaign\n            ,concat_ws(',', collect_list(cast(type as string))) as type\n            --,concat_ws(',', collect_list(cast(token_desc as string))) as token_desc\n            ,concat_ws(',', collect_list(cast(tokenType as string))) as tokenType\n            ,concat_ws(',', collect_list(cast(io as string))) as io\n            --,concat_ws(',', collect_list(cast(io_desc as string))) as io_desc\n            ,concat_ws(',', collect_list(cast(num as string))) as num\n            ,max(quankey) as quankey\n    from\n    (\n        select\n                idcampaign\n                ,type         --道具类型\n                ,tokenType   --令牌id\n                ,io          --需求、活动、奖励\n                ,num         --数量\n                ,quankey\n        from fdm.fdm_pricemanage_promotiontoken_chain\n        where dp in( 'ACTIVE','HISTORY')\n        and promotiontype=10\n    )x\n    group by idcampaign\n)promotiontoken\non unit.id=promotiontoken.idcampaign\nleft outer join\n(\n    select\n            promoid\n            ,type\n            ,area\n    from\n    (\n        select\n                promoid\n                --,concat_ws(',',collect_list(cast(type as string))) as type\n                --,concat_ws(',',collect_list(cast(area as string))) as area\n                ,concat_ws(',', collect_set(cast(type as string))) as type\n                ,concat_ws(',', collect_set(cast(area as string))) as area\n        from fdm.fdm_pricemanage_promoarea_chain\n        where dp in( 'ACTIVE','HISTORY')\n        and promotype=10\n        and yn=1\n        group by promoid\n    )x\n)promoarea\non unit.id=promoarea.promoid\nleft outer join\n(\n    select\n           rfid  --促销编号\n           ,idmainproduct  --主商品编号\n           ,num           --主品数量\n           ,buytype       --主品购买类型\n           ,price         --主品会员价\n           ,inprice       --主品进货价\n           ,cbj           --主品仓报价\n           ,yn            --主品是否有效\n           ,otc_tm\n           ,utc_tm\n    from\n    (\n        select\n               rfid  --促销编号\n               ,idmainproduct  --主商品编号\n               ,num           --主品数量\n               ,buytype       --主品购买类型\n               ,price         --主品会员价\n               ,inprice       --主品进货价\n               ,cbj           --主品仓报价\n               ,yn            --主品是否有效\n        from fdm.fdm_pricemanage_promotionmainproduct_chain\n        where dp in( 'ACTIVE','HISTORY')\n        and yn=1\n    )x\n    left outer join\n    (\n        select  item_sku_id\n                ,item_first_cate_cd\n                ,otc_tm\n                ,utc_tm\n        from gdm.gdm_m03_item_sku_da\n        where dt='2018-10-23'\n    )item_sku\n    on x.idmainproduct=item_sku.item_sku_id\n    where item_sku.item_first_cate_cd not in  ('9259','10825')  --测试数据\n    group by\n              rfid  --促销编号\n              ,idmainproduct  --主商品编号\n              ,num           --主品数量\n              ,buytype       --主品购买类型\n              ,price         --主品会员价\n              ,inprice       --主品进货价\n              ,cbj           --主品仓报价\n              ,yn            --主品是否有效\n              ,otc_tm\n              ,utc_tm\n)promotionmainproduct\non unit.id=promotionmainproduct.rfid\nleft outer join\n(\n    select\n            promoid\n            ,needmoney\n            ,addmoney\n            ,created\n            ,modified\n            ,neednum\n            ,num\n            ,minpoolnum\n            ,minskunum\n            ,rate\n            ,exttype\n            ,maxskunum\n            ,rank as rid\n            ,yn\n            ,idproduct--赠品编号\n            ,rfid --促销id\n            ,num1 --赠品数量\n            ,awardtype --赠送类型 0 必选 ，1可选\n            ,price --会员价\n            ,inprice--进货价\n            ,cbj  --提交促销时的仓报价\n            ,yn1 ---是否有效\n            ,skutype--商品类型 0 附件，1 赠品\n            ,poolno\n            ,showstate\n            ,buyprice\n            ,state\n            ,ruleid\n    from\n    (\n        select\n                promoid\n                ,needmoney\n                ,addmoney\n                ,created\n                ,modified\n                ,neednum\n                ,num\n                ,minpoolnum\n                ,minskunum\n                ,rate\n                ,exttype\n                ,maxskunum\n                ,rid\n                ,yn\n                ,idproduct--赠品编号\n                ,rfid --促销id\n                ,num1 --赠品数量\n                ,awardtype --赠送类型 0 必选 ，1可选\n                ,price --会员价\n                ,inprice--进货价\n                ,cbj  --提交促销时的仓报价\n                ,yn1 ---是否有效\n                ,skutype--商品类型 0 附件，1 赠品\n                ,poolno\n                ,showstate\n                ,buyprice\n                ,state\n                ,ruleid\n                ,dense_rank() over(partition by promoid order by nvl(neednum,needmoney)) as rank\n        from\n        (\n            select\n                    promoid\n                    ,needmoney\n                    ,addmoney\n                    ,created\n                    ,modified\n                    ,neednum\n                    ,m.num as num\n                    ,minpoolnum\n                    ,minskunum\n                    ,rate\n                    ,exttype\n                    ,maxskunum\n                    ,rid\n                    ,m.yn as yn\n                    ,idproduct--赠品编号\n                    ,rfid --促销id\n                    ,n.num as num1--赠品数量\n                    ,awardtype --赠送类型 0 必选 ，1可选\n                    ,price --会员价\n                    ,inprice--进货价\n                    ,cbj  --提交促销时的仓报价\n                    ,n.yn as yn1---是否有效\n                    ,skutype--商品类型 0 附件，1 赠品\n                    ,poolno\n                    ,showstate\n                    ,buyprice\n                    ,state\n                    ,ruleid\n            from\n            (\n                select\n                       promoid\n                       ,nvl(needmoney,0.0) as needmoney\n                       ,addmoney\n                       ,created\n                       ,modified\n                       ,neednum\n                       ,num\n                       ,minpoolnum\n                       ,minskunum\n                       ,rate\n                       ,exttype\n                       ,maxskunum\n                       ,rid\n                       ,yn\n                       ,id\n                from fdm.fdm_pricemanage_totalpromorule_chain\n                where dp in( 'ACTIVE','HISTORY')\n                and promotype=10\n                and yn=1\n            )m\n            left outer join\n            (\n                select\n                         idproduct--赠品编号\n                        ,rfid --促销id\n                        ,num --赠品数量\n                        ,awardtype --赠送类型 0 必选 ，1可选\n                        ,price --会员价\n                        ,inprice--进货价\n                        ,cbj  --提交促销时的仓报价\n                        ,yn ---是否有效\n                        ,skutype--商品类型 0 附件，1 赠品\n                        ,poolno\n                        ,showstate\n                        ,buyprice\n                        ,state\n                        ,ruleid\n                from fdm.fdm_pricemanage_promotionlargess_chain\n                where dp in( 'ACTIVE','HISTORY')\n                --and yn=1\n                and (trim(ruleid) is not null and trim(ruleid) <>'')\n            )n\n            on trim(m.Id) =trim(n.ruleid) and trim(m.promoid)=trim(n.rfid)\n        )xxx\n    )y\n)totalpromorule\non unit.id=totalpromorule.promoid\nleft outer join\n(\n    select\n              idproduct--赠品编号\n             ,rfid --促销id\n             ,num --赠品数量\n             ,awardtype --赠送类型 0 必选 ，1可选\n             ,price --会员价\n             ,inprice--进货价\n             ,cbj  --提交促销时的仓报价\n             ,yn ---是否有效\n             ,skutype--商品类型 0 附件，1 赠品\n             ,poolno\n             ,showstate\n             ,buyprice\n             ,state\n             ,ruleid\n    from fdm.fdm_pricemanage_promotionlargess_chain\n    where dp in( 'ACTIVE','HISTORY')  --and yn=1\n    and (trim(ruleid) is null or trim(ruleid)='')\n)promotionlargess\non trim(unit.Id) =trim(promotionlargess.rfid)\nleft outer join\n(\n    select\n            promoid\n            ,suppliertype\n            ,suppliercode\n            ,suppliername\n    from fdm.fdm_pricemanage_promotionsuppliers_chain\n    where dp in( 'ACTIVE','HISTORY')\n    and promotype=10  --促销供应商表\n)promotionsuppliers\non unit.id=promotionsuppliers.promoid\nleft outer join\n(\n    select\n            promoid\n            ,totalpromorule.needMoney as  needMoney\n            ,promotiontoken.num as  num\n            ,totalpromorule.minpoolnum as minpoolnum\n            ,totalpromorule.minskunum as minskunum\n            ,totalpromorule.maxskunum as maxskunum\n            ,totalpromorule.needNum as needNum\n            ,totalpromorule.rate as  rate\n            ,type\n            ,tokenType\n            ,io\n            ,rid\n    from\n    (\n        select\n                promoid\n                ,needmoney\n                ,addmoney\n                ,created\n                ,modified\n                ,neednum\n                ,num\n                ,minpoolnum\n                ,minskunum\n                ,rate\n                ,exttype\n                ,maxskunum\n                ,rank as rid\n                ,yn\n        from\n        (\n            select\n                    promoid\n                    ,needmoney\n                    ,addmoney\n                    ,created\n                    ,modified\n                    ,neednum\n                    ,num\n                    ,minpoolnum\n                    ,minskunum\n                    ,rate\n                    ,exttype\n                    ,maxskunum\n                    ,rid\n                    ,yn\n                    ,row_number(promoid) as rank\n            from\n            (\n                select\n                       promoid\n                       ,nvl(needmoney,0.0) as needmoney\n                       ,addmoney\n                       ,created\n                       ,modified\n                       ,neednum\n                       ,num\n                       ,minpoolnum\n                       ,minskunum\n                       ,rate\n                       ,exttype\n                       ,maxskunum\n                       ,rid\n                       ,yn\n                from fdm.fdm_pricemanage_totalpromorule_chain\n                where dp in( 'ACTIVE','HISTORY')  and promotype=10\n                distribute by promoid\n                sort by promoid, nvl(neednum,needmoney)\n            )x\n        )y\n    )totalpromorule\n    left outer join\n    (\n        select\n                idcampaign\n                ,type\n                ,tokenType\n                ,io\n                ,num\n                ,row_number(idcampaign) as rank\n        from\n        (\n            select\n                    idcampaign\n                    ,type         --道具类型\n                    ,tokenType   --令牌id\n                    ,io          --需求、活动、奖励\n                    ,nvl(num,0)      as  num  --数量\n            from fdm.fdm_pricemanage_promotiontoken_chain\n            where dp in( 'ACTIVE','HISTORY')\n            and promotiontype=10\n            distribute by idcampaign\n            sort by idcampaign, num\n        )xx\n    )promotiontoken\n    on promotiontoken.idcampaign=totalpromorule.promoid and promotiontoken.rank=totalpromorule.rid\n)jieti\non totalpromorule.promoid = jieti.promoid and totalpromorule.rid = jieti.rid"},"workflowNodeName":{"string":"Stage-21"},"workflowAdjacencies":{"string":"\"Stage-2\"=\"Stage-35\" \"Stage-3\"=\"Stage-33\" \"Stage-0\"=\"Stage-7\" \"Stage-1\"=\"Stage-37\" \"Stage-6\"=\"Stage-12\" \"Stage-4\"=\"Stage-31\" \"Stage-5\"=\"Stage-29\" \"Stage-41\"=\"Stage-20\" \"Stage-42\"=\"Stage-29\" \"Stage-20\"=\"Stage-21\" \"Stage-43\"=\"Stage-49,Stage-26\" \"Stage-21\"=\"Stage-33\" \"Stage-44\"=\"Stage-28\" \"Stage-45\"=\"Stage-30\" \"Stage-46\"=\"Stage-32\" \"Stage-47\"=\"Stage-34\" \"Stage-25\"=\"Stage-43\" \"Stage-48\"=\"Stage-36\" \"Stage-26\"=\"Stage-29\" \"Stage-49\"=\"Stage-42\" \"Stage-27\"=\"Stage-43\" \"Stage-28\"=\"Stage-12\" \"Stage-29\"=\"Stage-44,Stage-6\" \"Stage-8\"=\"Stage-0\" \"Stage-9\"=\"Stage-0\" \"Stage-30\"=\"Stage-29\" \"Stage-31\"=\"Stage-45,Stage-5\" \"Stage-32\"=\"Stage-31\" \"Stage-10\"=\"Stage-11\" \"Stage-33\"=\"Stage-46,Stage-4\" \"Stage-11\"=\"Stage-0\" \"Stage-34\"=\"Stage-33\" \"Stage-12\"=\"Stage-9,Stage-8,Stage-10\" \"Stage-35\"=\"Stage-47,Stage-3\" \"Stage-13\"=\"Stage-37\" \"Stage-36\"=\"Stage-35\" \"Stage-14\"=\"Stage-35\" \"Stage-37\"=\"Stage-48,Stage-2\" \"Stage-15\"=\"Stage-33\" \"Stage-16\"=\"Stage-33\" \"Stage-39\"=\"Stage-17\" \"Stage-17\"=\"Stage-18\" \"Stage-18\"=\"Stage-33\" "},"workflowTags":{"string":""}}}}

{"type":"JOB_QUEUE_CHANGED","event":{"org.apache.hadoop.mapreduce.jobhistory.JobQueueChange":{"jobid":"job_1540267209011_318173","jobQueueName":"root.bdp_jdw_dd_edw_test"}}}

{"type":"JOB_INITED","event":{"org.apache.hadoop.mapreduce.jobhistory.JobInited":{"jobid":"job_1540267209011_318173","launchTime":1540377959590,"totalMaps":2,"totalReduces":3,"jobStatus":"INITED","uberized":false}}}

{"type":"JOB_INFO_CHANGED","event":{"org.apache.hadoop.mapreduce.jobhistory.JobInfoChange":{"jobid":"job_1540267209011_318173","submitTime":1540377954416,"launchTime":1540377959590}}}

{"type":"TASK_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskStarted":{"taskid":"task_1540267209011_318173_m_000000","taskType":"MAP","startTime":1540377960281,"splitLocations":"BJLFRZ-10k-14-202.hadoop.jd.local,BJLFRZ-10k-34-132.hadoop.jd.local,BJLFRZ-10k-5-202.hadoop.jd.local,BJLFRZ-10k-16-105.hadoop.jd.local,BJLFRZ-10k-80-227.hadoop.jd.local,BJLFRZ-10k-13-165.hadoop.jd.local,BJLFRZ-10k-4-73.hadoop.jd.local,BJLFRZ-10k-148-9.hadoop.jd.local,BJLFRZ-10k-110-70.hadoop.jd.local,BJLFRZ-10k-17-41.hadoop.jd.local,BJLFRZ-10k-149-136.hadoop.jd.local,BJLFRZ-10k-21-231.hadoop.jd.local,BJLFRZ-10k-25-6.hadoop.jd.local,BJLFRZ-10k-75-5.hadoop.jd.local,BJLFRZ-10k-157-10.hadoop.jd.local"}}}

{"type":"TASK_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskStarted":{"taskid":"task_1540267209011_318173_m_000001","taskType":"MAP","startTime":1540377960738,"splitLocations":"BJLFRZ-10k-146-230.hadoop.jd.local,BJLFRZ-10k-119-34.hadoop.jd.local,BJLFRZ-10k-103-235.hadoop.jd.local,BJLFRZ-10k-107-198.hadoop.jd.local,BJLFRZ-10k-131-201.hadoop.jd.local,BJLFRZ-10k-14-107.hadoop.jd.local,BJLFRZ-10k-148-137.hadoop.jd.local,BJLFRZ-10k-28-104.hadoop.jd.local,BJLFRZ-10k-21-171.hadoop.jd.local,BJLFRZ-10k-147-7.hadoop.jd.local,BJLFRZ-10k-15-6.hadoop.jd.local,BJLFRZ-10k-81-235.hadoop.jd.local"}}}

{"type":"TASK_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskStarted":{"taskid":"task_1540267209011_318173_r_000000","taskType":"REDUCE","startTime":1540377960738,"splitLocations":""}}}

{"type":"TASK_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskStarted":{"taskid":"task_1540267209011_318173_r_000001","taskType":"REDUCE","startTime":1540377960739,"splitLocations":""}}}

{"type":"TASK_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskStarted":{"taskid":"task_1540267209011_318173_r_000002","taskType":"REDUCE","startTime":1540377960739,"splitLocations":""}}}

{"type":"MAP_ATTEMPT_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskAttemptStarted":{"taskid":"task_1540267209011_318173_m_000001","taskType":"MAP","attemptId":"attempt_1540267209011_318173_m_000001_0","startTime":1540377962974,"trackerName":"BJLFRZ-10k-34-136.hadoop.jd.local","httpPort":8042,"shufflePort":13562,"containerId":"container_e06_1540267209011_318173_01_000003","locality":{"string":"OFF_SWITCH"},"avataar":{"string":"VIRGIN"}}}}

{"type":"MAP_ATTEMPT_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskAttemptStarted":{"taskid":"task_1540267209011_318173_m_000000","taskType":"MAP","attemptId":"attempt_1540267209011_318173_m_000000_0","startTime":1540377962978,"trackerName":"BJLFRZ-10k-4-66.hadoop.jd.local","httpPort":8042,"shufflePort":13562,"containerId":"container_e06_1540267209011_318173_01_000002","locality":{"string":"RACK_LOCAL"},"avataar":{"string":"VIRGIN"}}}}

{"type":"MAP_ATTEMPT_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.MapAttemptFinished":{"taskid":"task_1540267209011_318173_m_000001","attemptId":"attempt_1540267209011_318173_m_000001_0","taskType":"MAP","taskStatus":"SUCCEEDED","mapFinishTime":1540377983141,"finishTime":1540377989621,"hostname":"BJLFRZ-10k-34-136.hadoop.jd.local","port":50086,"rackname":"/rack/rackA5M4401G05","state":"hdfs://ns6/tmp/hive/dd_edw_test/b8306643-d5cf-48ca-822a-8b7673117c38/hive_2018-10-24_18-00-27_209_3055974883112875322-1/-mr-10013/000008_0:0+31922828","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":0},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":32252017},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":127615268},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":0},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":18},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":0}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"MAP_INPUT_RECORDS","displayName":"Map input records","value":3106589},{"name":"MAP_OUTPUT_RECORDS","displayName":"Map output records","value":3106589},{"name":"MAP_OUTPUT_BYTES","displayName":"Map output bytes","value":144999874},{"name":"MAP_OUTPUT_MATERIALIZED_BYTES","displayName":"Map output materialized bytes","value":31888947},{"name":"SPLIT_RAW_BYTES","displayName":"Input split bytes","value":769},{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":3106589},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":0},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":113},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":28390},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1722372096},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":10967588864},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1983381504}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"DESERIALIZE_ERRORS","displayName":"DESERIALIZE_ERRORS","value":0},{"name":"RECORDS_IN","displayName":"RECORDS_IN","value":3106589},{"name":"RECORDS_OUT_INTERMEDIATE","displayName":"RECORDS_OUT_INTERMEDIATE","value":3106589}]},{"name":"org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter","displayName":"File Input Format Counters ","counts":[{"name":"BYTES_READ","displayName":"Bytes Read","value":0}]}]},"clockSplits":[4936,4936,4590,1524,1516,1516,2089,953,3440,377,377,377],"cpuUsages":[4994,4994,4902,1678,1559,1560,1743,1743,3843,458,458,458],"gpuUsages":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],"vMemKbytes":[2663985,7991957,10710256,10710535,10710536,10710535,10710536,10710535,10710536,10710536,10710535,10710536],"physMemKbytes":[314864,944593,1422988,1497905,1534816,1534841,1568945,1637361,1681421,1681615,1681770,1681926]}}}

{"type":"TASK_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskFinished":{"taskid":"task_1540267209011_318173_m_000001","taskType":"MAP","finishTime":1540377989621,"status":"SUCCEEDED","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":0},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":32252017},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":127615268},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":0},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":18},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":0}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"MAP_INPUT_RECORDS","displayName":"Map input records","value":3106589},{"name":"MAP_OUTPUT_RECORDS","displayName":"Map output records","value":3106589},{"name":"MAP_OUTPUT_BYTES","displayName":"Map output bytes","value":144999874},{"name":"MAP_OUTPUT_MATERIALIZED_BYTES","displayName":"Map output materialized bytes","value":31888947},{"name":"SPLIT_RAW_BYTES","displayName":"Input split bytes","value":769},{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":3106589},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":0},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":113},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":28390},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1722372096},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":10967588864},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1983381504}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"DESERIALIZE_ERRORS","displayName":"DESERIALIZE_ERRORS","value":0},{"name":"RECORDS_IN","displayName":"RECORDS_IN","value":3106589},{"name":"RECORDS_OUT_INTERMEDIATE","displayName":"RECORDS_OUT_INTERMEDIATE","value":3106589}]},{"name":"org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter","displayName":"File Input Format Counters ","counts":[{"name":"BYTES_READ","displayName":"Bytes Read","value":0}]}]},"successfulAttemptId":{"string":"attempt_1540267209011_318173_m_000001_0"}}}}

{"type":"MAP_ATTEMPT_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.MapAttemptFinished":{"taskid":"task_1540267209011_318173_m_000000","attemptId":"attempt_1540267209011_318173_m_000000_0","taskType":"MAP","taskStatus":"SUCCEEDED","mapFinishTime":1540377985917,"finishTime":1540377993421,"hostname":"BJLFRZ-10k-4-66.hadoop.jd.local","port":50086,"rackname":"/rack/rackA1M2402B10","state":"hdfs://ns6/tmp/hive/dd_edw_test/b8306643-d5cf-48ca-822a-8b7673117c38/hive_2018-10-24_18-00-27_209_3055974883112875322-1/-mr-10013/000004_0:0+32061504","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":0},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":40021567},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":159831455},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":0},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":22},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":0}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"MAP_INPUT_RECORDS","displayName":"Map input records","value":3888320},{"name":"MAP_OUTPUT_RECORDS","displayName":"Map output records","value":3888320},{"name":"MAP_OUTPUT_BYTES","displayName":"Map output bytes","value":181590519},{"name":"MAP_OUTPUT_MATERIALIZED_BYTES","displayName":"Map output materialized bytes","value":39658498},{"name":"SPLIT_RAW_BYTES","displayName":"Input split bytes","value":925},{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":3888320},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":0},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":98},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":32320},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1724583936},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":10972741632},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1970274304}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"DESERIALIZE_ERRORS","displayName":"DESERIALIZE_ERRORS","value":0},{"name":"RECORDS_IN","displayName":"RECORDS_IN","value":3888320},{"name":"RECORDS_OUT_INTERMEDIATE","displayName":"RECORDS_OUT_INTERMEDIATE","value":3888320}]},{"name":"org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter","displayName":"File Input Format Counters ","counts":[{"name":"BYTES_READ","displayName":"Bytes Read","value":0}]}]},"clockSplits":[6279,7563,1905,1899,1896,1893,2365,1413,3581,547,547,548],"cpuUsages":[6320,7827,2042,1978,1987,2085,2153,2199,3739,663,663,664],"gpuUsages":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],"vMemKbytes":[3349740,9511821,10715568,10715567,10715568,10715567,10715568,10715567,10715568,10715568,10715567,10715568],"physMemKbytes":[396921,1191472,1506662,1580599,1584849,1627618,1678589,1683676,1683809,1683910,1684011,1684113]}}}

{"type":"TASK_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskFinished":{"taskid":"task_1540267209011_318173_m_000000","taskType":"MAP","finishTime":1540377993421,"status":"SUCCEEDED","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":0},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":40021567},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":159831455},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":0},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":22},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":0}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"MAP_INPUT_RECORDS","displayName":"Map input records","value":3888320},{"name":"MAP_OUTPUT_RECORDS","displayName":"Map output records","value":3888320},{"name":"MAP_OUTPUT_BYTES","displayName":"Map output bytes","value":181590519},{"name":"MAP_OUTPUT_MATERIALIZED_BYTES","displayName":"Map output materialized bytes","value":39658498},{"name":"SPLIT_RAW_BYTES","displayName":"Input split bytes","value":925},{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":3888320},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":0},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":98},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":32320},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1724583936},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":10972741632},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1970274304}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"DESERIALIZE_ERRORS","displayName":"DESERIALIZE_ERRORS","value":0},{"name":"RECORDS_IN","displayName":"RECORDS_IN","value":3888320},{"name":"RECORDS_OUT_INTERMEDIATE","displayName":"RECORDS_OUT_INTERMEDIATE","value":3888320}]},{"name":"org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter","displayName":"File Input Format Counters ","counts":[{"name":"BYTES_READ","displayName":"Bytes Read","value":0}]}]},"successfulAttemptId":{"string":"attempt_1540267209011_318173_m_000000_0"}}}}

{"type":"REDUCE_ATTEMPT_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskAttemptStarted":{"taskid":"task_1540267209011_318173_r_000002","taskType":"REDUCE","attemptId":"attempt_1540267209011_318173_r_000002_0","startTime":1540377996072,"trackerName":"BJLFRZ-10k-48-166.hadoop.jd.local","httpPort":8042,"shufflePort":13562,"containerId":"container_e06_1540267209011_318173_01_000006","locality":{"string":"OFF_SWITCH"},"avataar":{"string":"VIRGIN"}}}}

{"type":"REDUCE_ATTEMPT_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskAttemptStarted":{"taskid":"task_1540267209011_318173_r_000000","taskType":"REDUCE","attemptId":"attempt_1540267209011_318173_r_000000_0","startTime":1540377996072,"trackerName":"BJLFRZ-10k-33-137.hadoop.jd.local","httpPort":8042,"shufflePort":13562,"containerId":"container_e06_1540267209011_318173_01_000004","locality":{"string":"OFF_SWITCH"},"avataar":{"string":"VIRGIN"}}}}

{"type":"REDUCE_ATTEMPT_STARTED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskAttemptStarted":{"taskid":"task_1540267209011_318173_r_000001","taskType":"REDUCE","attemptId":"attempt_1540267209011_318173_r_000001_0","startTime":1540377996073,"trackerName":"BJLFRZ-10k-13-43.hadoop.jd.local","httpPort":8042,"shufflePort":13562,"containerId":"container_e06_1540267209011_318173_01_000005","locality":{"string":"OFF_SWITCH"},"avataar":{"string":"VIRGIN"}}}}

{"type":"REDUCE_ATTEMPT_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.ReduceAttemptFinished":{"taskid":"task_1540267209011_318173_r_000001","attemptId":"attempt_1540267209011_318173_r_000001_0","taskType":"REDUCE","taskStatus":"SUCCEEDED","shuffleFinishTime":1540378000531,"sortFinishTime":1540378002394,"finishTime":1540378017445,"hostname":"BJLFRZ-10k-13-43.hadoop.jd.local","port":50086,"rackname":"/rack/rackA1M2402G14","state":"reduce > reduce","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":23294500},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":23657466},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":8588},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":98396194},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":3},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":2}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":2084389},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":23878742},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":2335110},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":2335110},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":2},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":2},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":91},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":25350},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1236496384},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":11029045248},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1960312832}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":1},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":2335110}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"clockSplits":[6777,441,441,441,440,441,441,441,1229,3369,3427,3476],"cpuUsages":[1499,1499,1499,1499,1499,1499,1499,1499,2063,3610,3643,4042],"gpuUsages":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],"vMemKbytes":[617178,1851534,3085891,4320247,5554604,6788960,8023317,9257673,10445573,10770552,10770551,10770552],"physMemKbytes":[45315,135945,226576,317207,407838,498468,589099,679730,772198,902154,1060514,1121752]}}}

{"type":"TASK_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskFinished":{"taskid":"task_1540267209011_318173_r_000001","taskType":"REDUCE","finishTime":1540378017445,"status":"SUCCEEDED","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":23294500},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":23657466},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":8588},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":98396194},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":3},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":2}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":2084389},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":23878742},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":2335110},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":2335110},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":2},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":2},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":91},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":25350},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1236496384},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":11029045248},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1960312832}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":1},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":2335110}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"successfulAttemptId":{"string":"attempt_1540267209011_318173_r_000001_0"}}}}

{"type":"REDUCE_ATTEMPT_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.ReduceAttemptFinished":{"taskid":"task_1540267209011_318173_r_000000","attemptId":"attempt_1540267209011_318173_r_000000_0","taskType":"REDUCE","taskStatus":"SUCCEEDED","shuffleFinishTime":1540378000864,"sortFinishTime":1540378002662,"finishTime":1540378017480,"hostname":"BJLFRZ-10k-33-137.hadoop.jd.local","port":50086,"rackname":"/rack/rackA5M4401F04","state":"reduce > reduce","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":23231618},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":23594584},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":8588},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":97951774},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":3},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":2}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":2083908},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":23814668},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":2328602},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":2328602},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":2},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":2},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":96},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":25160},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1228316672},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":11014410240},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1904214016}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":1},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":2328602}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"clockSplits":[7037,443,443,444,443,443,443,444,1115,3492,3378,3272],"cpuUsages":[1528,1528,1529,1528,1528,1529,1528,1529,2028,3752,3539,3614],"gpuUsages":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],"vMemKbytes":[612979,1838937,3064895,4290852,5516811,6742768,7968727,9194684,10390892,10758265,10756259,10756260],"physMemKbytes":[44081,132243,220406,308568,396731,484893,573056,661218,752048,919841,1123959,1168494]}}}

{"type":"TASK_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskFinished":{"taskid":"task_1540267209011_318173_r_000000","taskType":"REDUCE","finishTime":1540378017480,"status":"SUCCEEDED","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":23231618},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":23594584},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":8588},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":97951774},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":3},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":2}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":2083908},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":23814668},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":2328602},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":2328602},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":2},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":2},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":96},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":25160},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1228316672},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":11014410240},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1904214016}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":1},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":2328602}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"successfulAttemptId":{"string":"attempt_1540267209011_318173_r_000000_0"}}}}

{"type":"REDUCE_ATTEMPT_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.ReduceAttemptFinished":{"taskid":"task_1540267209011_318173_r_000002","attemptId":"attempt_1540267209011_318173_r_000002_0","taskType":"REDUCE","taskStatus":"SUCCEEDED","shuffleFinishTime":1540378000739,"sortFinishTime":1540378002566,"finishTime":1540378018543,"hostname":"BJLFRZ-10k-48-166.hadoop.jd.local","port":50086,"rackname":"/rack/rackA5M4402A06","state":"reduce > reduce","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":23269155},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":23631986},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":8588},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":98152308},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":3},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":2}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":2084337},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":23854035},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":2331197},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":2331197},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":2},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":2},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":139},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":27580},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1233850368},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":11087454208},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1983381504}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":1},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":2331197}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"clockSplits":[6967,451,452,451,451,452,451,452,1858,3549,3446,3483],"cpuUsages":[1687,1687,1688,1687,1688,1687,1688,1687,2669,3780,3648,3984],"gpuUsages":[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],"vMemKbytes":[634409,1903228,3172047,4440866,5709685,6978504,8247324,9516143,10646958,10827592,10827591,10827592],"physMemKbytes":[44906,134718,224531,314343,404156,493968,583781,673593,772141,925128,1041566,1131793]}}}

{"type":"TASK_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.TaskFinished":{"taskid":"task_1540267209011_318173_r_000002","taskType":"REDUCE","finishTime":1540378018543,"status":"SUCCEEDED","counters":{"name":"COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":23269155},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":23631986},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":8588},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":98152308},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":3},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":2}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":2084337},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":23854035},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":2331197},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":2331197},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":2},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":2},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":139},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":27580},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":1233850368},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":11087454208},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":1983381504}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":1},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":2331197}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"successfulAttemptId":{"string":"attempt_1540267209011_318173_r_000002_0"}}}}

{"type":"JOB_FINISHED","event":{"org.apache.hadoop.mapreduce.jobhistory.JobFinished":{"jobid":"job_1540267209011_318173","finishTime":1540378018554,"finishedMaps":2,"finishedReduces":3,"failedMaps":0,"failedReduces":0,"totalCounters":{"name":"TOTAL_COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":69795273},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":143157620},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":287472487},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":294500276},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":49},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":6}]},{"name":"org.apache.hadoop.mapreduce.JobCounter","displayName":"Job Counters ","counts":[{"name":"TOTAL_LAUNCHED_MAPS","displayName":"Launched map tasks","value":2},{"name":"TOTAL_LAUNCHED_REDUCES","displayName":"Launched reduce tasks","value":3},{"name":"OTHER_LOCAL_MAPS","displayName":"Other local map tasks","value":1},{"name":"RACK_LOCAL_MAPS","displayName":"Rack-local map tasks","value":1},{"name":"SLOTS_MILLIS_MAPS","displayName":"Total time spent by all maps in occupied slots (ms)","value":913440},{"name":"SLOTS_MILLIS_REDUCES","displayName":"Total time spent by all reduces in occupied slots (ms)","value":1044016},{"name":"MILLIS_MAPS","displayName":"Total time spent by all map tasks (ms)","value":57090},{"name":"MILLIS_REDUCES","displayName":"Total time spent by all reduce tasks (ms)","value":65251},{"name":"VCORES_MILLIS_MAPS","displayName":"Total vcore-seconds taken by all map tasks","value":57090},{"name":"VCORES_MILLIS_REDUCES","displayName":"Total vcore-seconds taken by all reduce tasks","value":65251},{"name":"MB_MILLIS_MAPS","displayName":"Total megabyte-seconds taken by all map tasks","value":467681280},{"name":"MB_MILLIS_REDUCES","displayName":"Total megabyte-seconds taken by all reduce tasks","value":534536192},{"name":"GCORES_MILLIS_MAPS","displayName":"Total gcore-seconds taken by all map tasks","value":0},{"name":"GCORES_MILLIS_REDUCES","displayName":"Total gcore-seconds taken by all reduce tasks","value":0}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"MAP_INPUT_RECORDS","displayName":"Map input records","value":6994909},{"name":"MAP_OUTPUT_RECORDS","displayName":"Map output records","value":6994909},{"name":"MAP_OUTPUT_BYTES","displayName":"Map output bytes","value":326590393},{"name":"MAP_OUTPUT_MATERIALIZED_BYTES","displayName":"Map output materialized bytes","value":71547445},{"name":"SPLIT_RAW_BYTES","displayName":"Input split bytes","value":1694},{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":6252634},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":71547445},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":6994909},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":13989818},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":6},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":6},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":537},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":138800},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":7145619456},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":55071240192},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":9801564160}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":3},{"name":"DESERIALIZE_ERRORS","displayName":"DESERIALIZE_ERRORS","value":0},{"name":"RECORDS_IN","displayName":"RECORDS_IN","value":6994909},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":6994909},{"name":"RECORDS_OUT_INTERMEDIATE","displayName":"RECORDS_OUT_INTERMEDIATE","value":6994909}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter","displayName":"File Input Format Counters ","counts":[{"name":"BYTES_READ","displayName":"Bytes Read","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]},"mapCounters":{"name":"MAP_COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":0},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":72273584},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":287446723},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":0},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":40},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":0}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"MAP_INPUT_RECORDS","displayName":"Map input records","value":6994909},{"name":"MAP_OUTPUT_RECORDS","displayName":"Map output records","value":6994909},{"name":"MAP_OUTPUT_BYTES","displayName":"Map output bytes","value":326590393},{"name":"MAP_OUTPUT_MATERIALIZED_BYTES","displayName":"Map output materialized bytes","value":71547445},{"name":"SPLIT_RAW_BYTES","displayName":"Input split bytes","value":1694},{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":6994909},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":0},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":211},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":60710},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":3446956032},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":21940330496},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":3953655808}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"DESERIALIZE_ERRORS","displayName":"DESERIALIZE_ERRORS","value":0},{"name":"RECORDS_IN","displayName":"RECORDS_IN","value":6994909},{"name":"RECORDS_OUT_INTERMEDIATE","displayName":"RECORDS_OUT_INTERMEDIATE","value":6994909}]},{"name":"org.apache.hadoop.mapreduce.lib.input.FileInputFormatCounter","displayName":"File Input Format Counters ","counts":[{"name":"BYTES_READ","displayName":"Bytes Read","value":0}]}]},"reduceCounters":{"name":"REDUCE_COUNTERS","groups":[{"name":"org.apache.hadoop.mapreduce.FileSystemCounter","displayName":"File System Counters","counts":[{"name":"FILE_BYTES_READ","displayName":"FILE: Number of bytes read","value":69795273},{"name":"FILE_BYTES_WRITTEN","displayName":"FILE: Number of bytes written","value":70884036},{"name":"FILE_READ_OPS","displayName":"FILE: Number of read operations","value":0},{"name":"FILE_LARGE_READ_OPS","displayName":"FILE: Number of large read operations","value":0},{"name":"FILE_WRITE_OPS","displayName":"FILE: Number of write operations","value":0},{"name":"HDFS_BYTES_READ","displayName":"HDFS: Number of bytes read","value":25764},{"name":"HDFS_BYTES_WRITTEN","displayName":"HDFS: Number of bytes written","value":294500276},{"name":"HDFS_READ_OPS","displayName":"HDFS: Number of read operations","value":9},{"name":"HDFS_LARGE_READ_OPS","displayName":"HDFS: Number of large read operations","value":0},{"name":"HDFS_WRITE_OPS","displayName":"HDFS: Number of write operations","value":6}]},{"name":"org.apache.hadoop.mapreduce.TaskCounter","displayName":"Map-Reduce Framework","counts":[{"name":"COMBINE_INPUT_RECORDS","displayName":"Combine input records","value":0},{"name":"COMBINE_OUTPUT_RECORDS","displayName":"Combine output records","value":0},{"name":"REDUCE_INPUT_GROUPS","displayName":"Reduce input groups","value":6252634},{"name":"REDUCE_SHUFFLE_BYTES","displayName":"Reduce shuffle bytes","value":71547445},{"name":"REDUCE_INPUT_RECORDS","displayName":"Reduce input records","value":6994909},{"name":"REDUCE_OUTPUT_RECORDS","displayName":"Reduce output records","value":0},{"name":"SPILLED_RECORDS","displayName":"Spilled Records","value":6994909},{"name":"SHUFFLED_MAPS","displayName":"Shuffled Maps ","value":6},{"name":"FAILED_SHUFFLE","displayName":"Failed Shuffles","value":0},{"name":"MERGED_MAP_OUTPUTS","displayName":"Merged Map outputs","value":6},{"name":"GC_TIME_MILLIS","displayName":"GC time elapsed (ms)","value":326},{"name":"CPU_MILLISECONDS","displayName":"CPU time spent (ms)","value":78090},{"name":"PHYSICAL_MEMORY_BYTES","displayName":"Physical memory (bytes) snapshot","value":3698663424},{"name":"VIRTUAL_MEMORY_BYTES","displayName":"Virtual memory (bytes) snapshot","value":33130909696},{"name":"COMMITTED_HEAP_BYTES","displayName":"Total committed heap usage (bytes)","value":5847908352}]},{"name":"HIVE","displayName":"HIVE","counts":[{"name":"CREATED_FILES","displayName":"CREATED_FILES","value":3},{"name":"RECORDS_OUT_0","displayName":"RECORDS_OUT_0","value":6994909}]},{"name":"Shuffle Errors","displayName":"Shuffle Errors","counts":[{"name":"BAD_ID","displayName":"BAD_ID","value":0},{"name":"CONNECTION","displayName":"CONNECTION","value":0},{"name":"IO_ERROR","displayName":"IO_ERROR","value":0},{"name":"WRONG_LENGTH","displayName":"WRONG_LENGTH","value":0},{"name":"WRONG_MAP","displayName":"WRONG_MAP","value":0},{"name":"WRONG_REDUCE","displayName":"WRONG_REDUCE","value":0}]},{"name":"org.apache.hadoop.mapreduce.lib.output.FileOutputFormatCounter","displayName":"File Output Format Counters ","counts":[{"name":"BYTES_WRITTEN","displayName":"Bytes Written","value":0}]}]}}}}
